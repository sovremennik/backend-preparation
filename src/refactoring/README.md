# Рефакторинг

## 1. Введение в рефакторинг
### 1.1. Что такое рефакторинг?
- Процесс улучшения внутренней структуры кода без изменения его внешнего поведения  
- Повышение читаемости, упрощение сопровождения и улучшение производительности  

### 1.2. Зачем нужен рефакторинг?
- Устранение технического долга  
- Повышение качества кода  
- Упрощение добавления новых функций  
- Снижение вероятности ошибок  

### 1.3. Когда проводить рефакторинг?
- Перед добавлением новой функциональности  
- Перед исправлением ошибок  
- В ходе код-ревью  
- Регулярно в рамках рабочего процесса  

### 1.4. Принципы рефакторинга
- Маленькие и контролируемые изменения  
- Наличие автотестов для проверки корректности  
- Итеративный процесс (постепенные улучшения)  

## 2. Виды рефакторинга
### 2.1. Поверхностный рефакторинг
- Переименование переменных, методов и классов  
- Форматирование кода  
- Упрощение условий и выражений  

### 2.2. Структурный рефакторинг
- Перераспределение обязанностей между классами  
- Декомпозиция крупных методов  
- Замена устаревших решений на современные паттерны  

### 2.3. Архитектурный рефакторинг
- Переход на микросервисную архитектуру  
- Выделение слоёв приложения (слой бизнес-логики, DAO)  
- Оптимизация взаимодействия модулей  

## 3. Категории техник рефакторинга
### 3.1. Упрощение кода
- **Extract Method** — Выделение метода  
- **Inline Method** — Встраивание метода  
- **Replace Temp with Query** — Замена временной переменной запросом  
- **Remove Dead Code** — Удаление неиспользуемого кода  

### 3.2. Работа с данными
- **Encapsulate Field** — Инкапсуляция поля  
- **Replace Magic Number with Constant** — Замена магических чисел на константы  
- **Introduce Parameter Object** — Введение объекта параметров  

### 3.3. Улучшение взаимодействия между объектами
- **Move Method/Field** — Перемещение метода/поля  
- **Extract Class** — Выделение класса  
- **Inline Class** — Встраивание класса  
- **Replace Inheritance with Delegation** — Замена наследования на делегирование  

### 3.4. Работа с условными конструкциями
- **Decompose Conditional** — Декомпозиция условного оператора  
- **Replace Nested Conditional with Guard Clauses** — Замена вложенных условий охранными выражениями  
- **Replace Conditional with Polymorphism** — Замена условных операторов полиморфизмом  

## 4. Инструменты для рефакторинга
### 4.1. IDE-инструменты
- IntelliJ IDEA (Java/Kotlin)  
- Eclipse  
- Visual Studio Code  

### 4.2. Анализаторы кода
- **SonarQube** — анализ кода и выявление дефектов  
- **PMD** — поиск ошибок и нарушений стиля  
- **Checkstyle** — проверка стиля кода  

### 4.3. Автоматизированное тестирование
- JUnit (Java)  
- Kotest (Kotlin)  
- Mockito — для создания моков  

## 5. Рефакторинг и паттерны проектирования
- Применение **паттернов GoF** для улучшения архитектуры  
- Замена устаревших решений на стандартные паттерны (**Strategy**, **Factory Method**)  
- Плавный переход на новые технологии через **Adapter**, **Decorator**  

## 6. Практика рефакторинга
### 6.1. Code Smells (Запахи кода)
- **Дублирование кода (Duplicated Code)**  
- **Крупный класс (Large Class)**  
- **Длинный метод (Long Method)**  
- **Разросшийся switch/case (Long Switch Statement)**  
- **Примитивная одержимость (Primitive Obsession)**  
- **Фрагментированный интерфейс (Feature Envy)**  

### 6.2. Как устранять запахи кода
- Декомпозиция методов  
- Выделение объектов  
- Оптимизация условий и циклов  

## 7. Полезные книги и ресурсы
- *Refactoring: Improving the Design of Existing Code* — Martin Fowler  
- *Clean Code: A Handbook of Agile Software Craftsmanship* — Robert C. Martin  
- *Refactoring Guru* — https://refactoring.guru/  
- *Working Effectively with Legacy Code* — Michael Feathers  

## 8. Рекомендации по рефакторингу
- Пишите автотесты перед началом рефакторинга  
- Делайте небольшие шаги с проверкой на каждом этапе  
- Работайте по принципу "работающий код → чище, лучше"  
- Избегайте избыточного рефакторинга без необходимости  
